version: "3.9"

services:
  apache:
    volumes:
      - ./.docker/webserver/demo.apache.conf:/usr/local/apache2/conf/demo.apache.conf

  php:
    build:
      args:
        # Install or not xDebug during the build of the php service?
        - XDEBUG_INSTALL=${XDEBUG_INSTALL}
        - XDEBUG_MAJOR_VERSION=${XDEBUG_MAJOR_VERSION}
        - XDEBUG_FULL_VERSION=${XDEBUG_FULL_VERSION}
    volumes:
      # Allow to sync the /src folder of the development machine to the
      # /var/www/html folder in the Docker container.
      - ./src:/var/www/html
      # Settings for vscode to allow working in the container
      - ./.vscode:/var/www/.vscode
      # Synchronize the ini file for PHP with the configuration for xDebug
      # use the v2 or the v3 configuration file based on the xDebug version used.
      - ./.docker/php/conf.d/xdebug_v${XDEBUG_MAJOR_VERSION}.ini:/usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini
      # During development, enable errors to be reported to the developer
      - ./.docker/php/conf.d/error_reporting.ini:/usr/local/etc/php/conf.d/error_reporting.ini
