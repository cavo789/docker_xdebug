version: "3.7"
services:

  apache:
    build:
      context: .
      dockerfile: ./.docker/webserver/Dockerfile
    depends_on:
      - php
    networks:
      - backend
    ports:
      - 8080:80
    volumes:
      - ./src:/var/www/html

  php:
    build:
      context: .
      dockerfile: ./.docker/php/Dockerfile
      args:
        - XDEBUG_VERSION=${XDEBUG_VERSION}
    networks:
      - backend
      - frontend
    # ports:
    #   # The webserver service is communicating with PHP on default port 9000
    #   - 9000
    #   # - ${XDEBUG_PORT}:${XDEBUG_PORT}
    volumes:
      - ./src:/var/www/html
      - ./.docker/php/conf.d/xdebug.ini:/usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini
      - ./.docker/php/conf.d/error_reporting.ini:/usr/local/etc/php/conf.d/error_reporting.ini

networks:
  frontend:
  backend:
